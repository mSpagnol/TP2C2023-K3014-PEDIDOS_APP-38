USE GD1C2023
GO


/* CREANDO SCHEMA */
CREATE SCHEMA PEDIDOS_APP
GO

/* CREANDO TABLAS */

CREATE TABLE PEDIDOS_APP.RECLAMO (
	RECLAMO_NRO decimal(18,0) PRIMARY KEY,
	RECLAMO_TIPO nvarchar(50) ,
	RECLAMO_ESTADO nvarchar(50),
	RECLAMO_DESCRIPCION nvarchar(50),
	RECLAMO_SOLUCION nvarchar(255),
	RECLAMO_FECHA datetime2(3) ,
	RECLAMO_CALIFICACION decimal(18,0),
	USUARIO_DNI decimal(18,0),
	PEDIDO_NRO decimal(18,0)
);

CREATE TABLE PEDIDOS_APP.CUPON(
	CUPON_NRO decimal(18,0) PRIMARY KEY,
	CUPON_MONTO decimal(18,2),
	CUPON_TIPO nvarchar(50),
	CUPON_FECHA_ALTA datetime2(3),
	CUPON_FECHA_VENCIMIENTO datetime2(3),
);

CREATE TABLE PEDIDOS_APP.CUPON_RECLAMO(
	CUPON_RECLAMO_NRO decimal(18,0) PRIMARY KEY,
	CUPON_RECLAMO_MONTO decimal(18,2),
	CUPON_RECLAMO_FECHA_ALTA datetime2 (3),
	CUPON_RECLAMO_FECHA_VENCIMIENTO datetime2(3),
	CUPON_RECLAMO_TIPO nvarchar(50),
	RECLAMO_NRO decimal(18,0)
);

CREATE TABLE PEDIDOS_APP.USUARIO_X_CUPON(
	USUARIO_X_CUPON_NRO decimal(18,0) PRIMARY KEY,
	CUPON_NRO decimal(18,0),
	USUARIO_DNI decimal(18,0)
);

CREATE TABLE PEDIDOS_APP.PEDIDO_X_CUPON(
	PEDIDO_X_CUPON_NRO decimal(18,0) PRIMARY KEY,
	CUPON_NRO decimal(18,0),
	PEDIDO_NRO decimal(18,0)
);

CREATE TABLE PEDIDOS_APP.PRODUCTO_X_PEDIDO(
	PEDIDO_NRO decimal(18,0),
	PRODUCTO_LOCAL_CODIGO nvarchar(50),
	PRODUCTO_CANTIDAD decimal(18,0)
);

CREATE TABLE PEDIDOS_APP.PRODUCTO_LOCAL(
	PRODUCTO_LOCAL_CODIGO nvarchar(50) PRIMARY KEY,
	PRODUCTO_LOCAL_PRECIO decimal(18,2),
	PRODUCTO_LOCAL_NOMBRE nvarchar(50),
	PRODUCTO_LOCAL_DESCRIPCION nvarchar(255),
	LOCAL_CODIGO nvarchar(50),
);

CREATE TABLE PEDIDOS_APP.PEDIDO(
	PEDIDO_NRO decimal(18,0) PRIMARY KEY,
	PEDIDO_TOTAL_PRODUCTOS decimal(18,2),
	PEDIDO_PRECIO_ENVIO decimal(18,2),
	PEDIDO_TARIFA_SERVICIO decimal(18,2),
	PEDIDO_PROPINA decimal(18,2),
	PEDIDO_OBSERV nvarchar(255),
	PEDIDO_TOTAL_CUPONES decimal(18,2),
	PEDIDO_TOTAL_SERVICIO decimal(18,2),
	PEDIDO_FECHA datetime2(3),
	PEDIDO_FECHA_ENTREGA datetime2(3),
	PEDIDO_TIEMPO_ESTIMADO_ENTREGA decimal(18,2),
	MEDIO_DE_PAGO_NRO decimal(16,0),
	LOCAL_CODIGO nvarchar(50),
	USUARIO_DNI decimal(18,0),
);

CREATE TABLE PEDIDOS_APP.USUARIO(
	USUARIO_DNI decimal(18,0),
	USUARIO_NOMBRE nvarchar(255),
	USUARIO_APELLIDO nvarchar(255),
	USUARIO_FECHA_REGISTRO datetime2(3),
	USUARIO_TELEFONO decimal(18,0),
	USUARIO_MAIL nvarchar(255),
	USUARIO_FECHA_NAC date,
	MEDIO_DE_PAGO_NRO decimal(16,0)
);

/* CREACION DE FOREIGN KEYS */

ALTER TABLE PEDIDOS_APP.RECLAMO ADD CONSTRAINT FK_USUARIO_DNI FOREIGN KEY (USUARIO_DNI) REFERENCES PEDIDOS_APP.USUARIO(USUARIO_DNI)
GO

ALTER TABLE PEDIDOS_APP.RECLAMO ADD CONSTRAINT FK_PEDIDO_NRO FOREIGN KEY (PEDIDO_NRO) REFERENCES PEDIDOS_APP.PEDIDO(PEDIDO_NRO)
GO

ALTER TABLE PEDIDOS_APP.RECLAMO_X_CUPON ADD CONSTRAINT FK_CUPON_NRO FOREIGN KEY (CUPON_NRO) REFERENCES PEDIDOS_APP.CUPON(CUPON_NRO)
GO

ALTER TABLE PEDIDOS_APP.USUARIO_X_CUPON ADD CONSTRAINT FK_CUPON_NRO FOREIGN KEY (CUPON_NRO) REFERENCES PEDIDOS_APP.CUPON(CUPON_NRO)
GO

ALTER TABLE PEDIDOS_APP.USUARIO_X_CUPON ADD CONSTRAINT FK_USUARIO_DNI FOREIGN KEY (USUARIO_DNI) REFERENCES PEDIDOS_APP.USUARIO(USUARIO_DNI)
GO

ALTER TABLE PEDIDOS_APP.PEDIDO_X_CUPON ADD CONSTRAINT FK_PEDIDO_NRO FOREIGN KEY (PEDIDO_NRO) REFERENCES PEDIDOS_APP.PEDIDO(PEDIDO_NRO)
GO

ALTER TABLE PEDIDOS_APP.CUPON_RECLAMO ADD CONSTRAINT FK_RECLAMO_NRO FOREIGN KEY (RECLAMO_NRO) REFERENCES PEDIDOS_APP.RECLAMO(RECLAMO_NRO)
GO

ALTER TABLE PEDIDOS_APP.PRODUCTO_X_PEDIDO ADD CONSTRAINT FK_PEDIDO_NRO FOREIGN KEY (PEDIDO_NRO) REFERENCES PEDIDOS_APP.PEDIDO(PEDIDO_NRO)
GO

ALTER TABLE PEDIDOS_APP.PRODUCTO_LOCAL ADD CONSTRAINT FK_LOCAL_NRO FOREIGN KEY (LOCAL_CODIGO) REFERENCES PEDIDOS_APP.LOCAL(LOCAL_CODIGO)
GO

ALTER TABLE PEDIDOS_APP.PEDIDO ADD CONSTRAINT FK_LOCAL_CODIGO FOREIGN KEY (LOCAL_CODIGO) REFERENCES PEDIDOS_APP.LOCAL(LOCAL_CODIGO)
GO

ALTER TABLE PEDIDOS_APP.PEDIDO ADD CONSTRAINT FK_MEDIO_DE_PAGO_NRO FOREIGN KEY (MEDIO_DE_PAGO_NRO) REFERENCES PEDIDOS_APP.MEDIO_DE_PAGO(MEDIO_DE_PAGO_NRO)
GO

ALTER TABLE PEDIDOS_APP.PEDIDO ADD CONSTRAINT FK_USUARIO_DNI FOREIGN KEY (USUARIO_DNI) REFERENCES PEDIDOS_APP.USUARIO(USUARIO_DNI)
GO

ALTER TABLE PEDIDOS_APP.USUARIO ADD CONSTRAINT FK_MEDIO_PAGO_NRO FOREIGN KEY (MEDIO_PAGO_NRO) REFERENCES PEDIDOS_APP.MEDIO_DE_PAGO(MEDIO_PAGO_NRO)
GO


